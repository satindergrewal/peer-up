# Relay Server Configuration
# This server runs on a VPS with a public IP
# It relays connections between home and client nodes

identity:
  # Path to the key file for persistent peer identity
  # This file will be created automatically if it doesn't exist
  # IMPORTANT: Keep this file backed up - your peer ID depends on it
  key_file: "relay_node.key"

network:
  # Addresses to listen on
  # Default: port 7777 TCP (non-standard to avoid IPFS swarms)
  # Make sure this port is open in your firewall (ufw allow 7777/tcp)
  listen_addresses:
    - "/ip4/0.0.0.0/tcp/7777"
    - "/ip6/::/tcp/7777"

    # Anti-censorship: WebSocket transport
    # Looks like regular HTTPS/WebSocket traffic to ISP deep packet inspection.
    # ISPs almost never block port 443 — it would break all web browsing.
    #
    # IMPORTANT: Port 443 is often used by web servers (nginx, Apache, Caddy).
    # Check first: ss -tlnp | grep :443
    # If port 443 is taken, use 8443 instead (still benefits from WebSocket
    # protocol blending, just on a non-standard port).
    #
    # Port 443 requires CAP_NET_BIND_SERVICE (setup-linode.sh adds this).
    # Port 8443 works without any special capabilities.
    #
    # - "/ip4/0.0.0.0/tcp/443/ws"
    # - "/ip6/::/tcp/443/ws"
    #
    # Fallback if 443 is taken:
    # - "/ip4/0.0.0.0/tcp/8443/ws"
    # - "/ip6/::/tcp/8443/ws"

security:
  # Path to authorized_keys file
  # Only peers listed here can connect to this relay
  # Add one peer ID per line (home-node and client-node peer IDs)
  authorized_keys_file: "relay_authorized_keys"

  # Enable connection gating — STRONGLY RECOMMENDED for production
  # When true, only peers in authorized_keys can use this relay
  # When false, any peer on the internet can relay through your VPS
  enable_connection_gating: true
